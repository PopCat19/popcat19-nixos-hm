# Rose Pine GTK Theming Guide

This guide covers comprehensive Rose Pine theming for GTK applications in your Hyprland environment on NixOS. This setup ensures consistent Rose Pine theming across all GTK2, GTK3, and GTK4 applications.

## üé® Theme Overview

Rose Pine is a warm, dark theme with the following color palette:
- **Base**: `#191724` - Background color
- **Surface**: `#1f1d2e` - Secondary background
- **Overlay**: `#26233a` - Tertiary background
- **Muted**: `#6e6a86` - Muted text
- **Subtle**: `#908caa` - Subtle text
- **Text**: `#e0def4` - Primary text
- **Love**: `#eb6f92` - Red accent
- **Gold**: `#f6c177` - Yellow accent
- **Rose**: `#ebbcba` - Pink accent
- **Pine**: `#31748f` - Teal accent
- **Foam**: `#9ccfd8` - Cyan accent
- **Iris**: `#c4a7e7` - Purple accent

## üìã Current Configuration

### Home Manager Configuration

Your `home.nix` includes the following Rose Pine GTK configuration:

```nix
gtk = {
  enable = true;
  cursorTheme = {
    name = "rose-pine-hyprcursor";
    size = 24;
    package = inputs.rose-pine-hyprcursor.packages.${system}.default;
  };
  theme = {
    name = "rose-pine-gtk-theme";
    package = pkgs.rose-pine-gtk-theme;
  };
  iconTheme = {
    name = "Papirus-Dark";
    package = pkgs.papirus-icon-theme;
  };
  font = {
    name = "CaskaydiaCove Nerd Font";
    size = 11;
  };

  # GTK3 specific settings
  gtk3.extraConfig = {
    gtk-application-prefer-dark-theme = true;
    gtk-decoration-layout = "appmenu:minimize,maximize,close";
    gtk-enable-animations = true;
    gtk-primary-button-warps-slider = false;
  };

  # GTK4 specific settings
  gtk4.extraConfig = {
    gtk-application-prefer-dark-theme = true;
    gtk-decoration-layout = "appmenu:minimize,maximize,close";
    gtk-enable-animations = true;
    gtk-primary-button-warps-slider = false;
  };
};
```

### Environment Variables

Essential environment variables are set in your session:

```nix
home.sessionVariables = {
  GTK_THEME = "rose-pine-gtk-theme";
  GDK_BACKEND = "wayland,x11,*";
  XCURSOR_THEME = "rose-pine-hyprcursor";
  XCURSOR_SIZE = "24";
  QT_QPA_PLATFORMTHEME = "qt6ct";
  QT_STYLE_OVERRIDE = "kvantum";
  QT_QPA_PLATFORM = "wayland;xcb";
};
```

### dconf Settings

System-wide theme settings via dconf:

```nix
dconf.settings = {
  "org/gnome/desktop/interface" = {
    cursor-theme = "rose-pine-hyprcursor";
    cursor-size = 24;
    gtk-theme = "rose-pine-gtk-theme";
    icon-theme = "Papirus-Dark";
    font-name = "CaskaydiaCove Nerd Font 11";
    document-font-name = "CaskaydiaCove Nerd Font 11";
    monospace-font-name = "CaskaydiaCove Nerd Font Mono 11";
    color-scheme = "prefer-dark";
  };
  "org/gnome/desktop/wm/preferences" = {
    theme = "rose-pine-gtk-theme";
  };
};
```

## üìÅ Configuration Files

### GTK 3 Settings (`~/.config/gtk-3.0/settings.ini`)

These settings are automatically generated by Home Manager based on your `gtk` configuration:

```ini
[Settings]
gtk-application-prefer-dark-theme=true
gtk-cursor-theme-name=rose-pine-hyprcursor
gtk-cursor-theme-size=24
gtk-decoration-layout=appmenu:minimize,maximize,close
gtk-enable-animations=true
gtk-font-name=CaskaydiaCove Nerd Font 11
gtk-icon-theme-name=Papirus-Dark
gtk-primary-button-warps-slider=false
gtk-theme-name=rose-pine-gtk-theme
```

### GTK 4 Settings (`~/.config/gtk-4.0/settings.ini`)

GTK4 settings are also managed by Home Manager and mirror GTK3 settings:

```ini
[Settings]
gtk-application-prefer-dark-theme=true
gtk-cursor-theme-name=rose-pine-hyprcursor
gtk-cursor-theme-size=24
gtk-decoration-layout=appmenu:minimize,maximize,close
gtk-enable-animations=true
gtk-font-name=CaskaydiaCove Nerd Font 11
gtk-icon-theme-name=Papirus-Dark
gtk-primary-button-warps-slider=false
gtk-theme-name=rose-pine-gtk-theme
```

### Custom CSS Overrides

#### GTK 3 CSS (`~/.config/gtk-3.0/gtk.css`)

Custom CSS is applied via Home Manager configuration to provide additional Rose Pine styling:

```css
/* Rose Pine GTK theme customizations */
@define-color rose_pine_base #191724;
@define-color rose_pine_surface #1f1d2e;
@define-color rose_pine_overlay #26233a;
@define-color rose_pine_muted #6e6a86;
@define-color rose_pine_subtle #908caa;
@define-color rose_pine_text #e0def4;
@define-color rose_pine_love #eb6f92;
@define-color rose_pine_gold #f6c177;
@define-color rose_pine_rose #ebbcba;
@define-color rose_pine_pine #31748f;
@define-color rose_pine_foam #9ccfd8;
@define-color rose_pine_iris #c4a7e7;

/* Ensure consistent theming for applications */
* {
  outline-color: @rose_pine_iris;
}

.nautilus-window notebook > header.top tabs tab {
  background: @rose_pine_surface;
  color: @rose_pine_text;
}

.nautilus-window notebook > header.top tabs tab:checked {
  background: @rose_pine_overlay;
  color: @rose_pine_rose;
}
```

#### GTK 4 CSS (`~/.config/gtk-4.0/gtk.css`)

GTK4 CSS customizations are managed through the main theme package. Home Manager handles the theme application automatically, avoiding conflicts with system-managed files. Additional GTK4 customizations can be made through the theme package itself or via application-specific overrides.

## üõ†Ô∏è Required Packages

The following packages are included in your configuration:

- `rose-pine-gtk-theme` - Main GTK theme
- `papirus-icon-theme` - Icon theme (dark variant)
- `nwg-look` - GTK theme configuration tool
- `dconf-editor` - System settings editor
- `rose-pine-hyprcursor` - Cursor theme (via flake input)

## üîß Tools and Scripts

### Theme Verification Script

Run the verification script to check your theming setup:

```bash
./scripts/verify-rose-pine-gtk.sh
```

### Theme Testing Script

Test GTK applications with Rose Pine theming:

```bash
./scripts/test-gtk-theme.sh
```

This script checks:
- GTK configuration files
- dconf settings
- Environment variables
- Package installation
- Theme application status

### Manual Theme Application

If themes aren't applied correctly, use these commands:

```bash
# Apply via gsettings
gsettings set org.gnome.desktop.interface gtk-theme 'rose-pine-gtk-theme'
gsettings set org.gnome.desktop.interface icon-theme 'Papirus-Dark'
gsettings set org.gnome.desktop.interface cursor-theme 'rose-pine-hyprcursor'

# Apply cursor in Hyprland
hyprctl setcursor rose-pine-hyprcursor 24

# Use nwg-look for visual configuration
nwg-look
```

## üéØ Application-Specific Theming

### File Managers
- **Nautilus**: Themed via GTK settings and custom CSS
- **Dolphin**: Uses Qt theming (covered in separate Qt guide)
- **Thunar**: Uses GTK theming automatically

### Text Editors
- **gedit**: Uses GTK theming
- **Text Editor (GNOME)**: Uses GTK4 theming
- **VS Code**: Requires separate Rose Pine extension

### Browsers
- **Firefox**: Can use system theme with proper settings
- **Zen Browser**: Configured in your setup

## üêõ Troubleshooting

### Theme Not Applied
1. Check if theme package is installed: `nix-store --query --references ~/.nix-profile | grep rose-pine`
2. Verify dconf settings: `dconf dump /org/gnome/desktop/interface/`
3. Restart applications or log out/in
4. Use `nwg-look` to verify theme selection

### Cursor Theme Issues
1. Ensure environment variables are set: `echo $XCURSOR_THEME`
2. Apply cursor manually: `hyprctl setcursor rose-pine-hyprcursor 24`
3. Check cursor files exist: `ls ~/.nix-profile/share/icons/rose-pine-hyprcursor/`

### Icon Theme Issues
1. Verify Papirus-Dark is installed: `ls ~/.nix-profile/share/icons/Papirus-Dark/`
2. Check icon theme setting: `gsettings get org.gnome.desktop.interface icon-theme`
3. Clear icon cache: `gtk-update-icon-cache -f ~/.nix-profile/share/icons/Papirus-Dark/`

### Mixed Themes
If some applications show different themes:
1. Check if they're Flatpak apps (need separate theming)
2. Verify XDG environment variables
3. Restart the application
4. Check application-specific theme settings

## üìö Related Guides

- [DOLPHIN_THEMING_GUIDE.md](./DOLPHIN_THEMING_GUIDE.md) - Qt/KDE theming for Dolphin
- [ROSE_PINE_SETUP.md](./ROSE_PINE_SETUP.md) - Overall Rose Pine setup
- [MANUAL_THEMING_GUIDE.md](./MANUAL_THEMING_GUIDE.md) - Manual theming procedures

## üîÑ Updating the Configuration

After making changes to your `home.nix`:

```bash
# Rebuild entire system with correct hostname
sudo nixos-rebuild switch --flake .#popcat19-nixos0

# Verify theme application
./scripts/verify-rose-pine-gtk.sh

# Test theme with various applications
./scripts/test-gtk-theme.sh
```

## üìù Notes

- GTK2 applications are legacy and may not follow theme perfectly
- Some applications (like Firefox) may need internal theme settings
- Flatpak applications require additional theme setup
- The configuration supports both Wayland and X11 environments
- Home Manager manages most GTK configuration files automatically
- Custom CSS files provide fine-tuned theming for specific applications
- GTK4 theming is handled through the main theme package to avoid conflicts
- File conflicts are avoided by letting Home Manager manage core settings files

## üé® Color Reference

For custom theming or application-specific configurations, use these Rose Pine colors:

| Color Name | Hex Code | Usage |
|------------|----------|-------|
| Base       | #191724  | Primary background |
| Surface    | #1f1d2e  | Secondary background |
| Overlay    | #26233a  | Elevated surfaces |
| Muted      | #6e6a86  | Disabled text |
| Subtle     | #908caa  | Secondary text |
| Text       | #e0def4  | Primary text |
| Love       | #eb6f92  | Error/danger |
| Gold       | #f6c177  | Warning |
| Rose       | #ebbcba  | Accent/highlight |
| Pine       | #31748f  | Info |
| Foam       | #9ccfd8  | Success |
| Iris       | #c4a7e7  | Focus/selection |

This comprehensive setup ensures consistent Rose Pine theming across all GTK applications in your Hyprland environment.